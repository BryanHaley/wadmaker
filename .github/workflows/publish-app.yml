name: build-app

on:
  push:
    branches: [ master ]

env:
  DOTNET_VERSION: '8.0.319'

jobs:
  build-lin-x64:
    runs-on: ubuntu-24.04

    steps:
      - uses: actions/checkout@v3

      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}

      - name: Build WadMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: WadMaker
          app-path: WadMaker
          project-file: WadMaker.csproj
      
      - name: Build SpriteMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: SpriteMaker
          app-path: SpriteMaker
          project-file: SpriteMaker.csproj
      
      - name: Build ModelTextureMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: ModelTextureMaker
          app-path: ModelTextureMaker
          project-file: ModelTextureMaker.csproj

  build-win-x64:
    runs-on: windows-2025

    steps:
      - uses: actions/checkout@v3
      
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}

      - name: Build WadMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: WadMaker
          app-path: WadMaker
          project-file: WadMaker.csproj
      
      - name: Build SpriteMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: SpriteMaker
          app-path: SpriteMaker
          project-file: SpriteMaker.csproj
      
      - name: Build ModelTextureMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: ModelTextureMaker
          app-path: ModelTextureMaker
          project-file: ModelTextureMaker.csproj

  build-win-x86:
    runs-on: windows-2025

    steps:
      - uses: actions/checkout@v3
      
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}

      - name: Build WadMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: WadMaker
          app-path: WadMaker
          project-file: WadMaker.csproj
      
      - name: Build SpriteMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: SpriteMaker
          app-path: SpriteMaker
          project-file: SpriteMaker.csproj
      
      - name: Build ModelTextureMaker
        uses: ./.github/actions/dotnet-publish-zip-win
        with:
          app-name: ModelTextureMaker
          app-path: ModelTextureMaker
          project-file: ModelTextureMaker.csproj

  build-mac-universal:
    runs-on: ubuntu-24.04

    steps:
      - uses: actions/checkout@v3

      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}

      - name: Build WadMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: WadMaker
          app-path: WadMaker
          project-file: WadMaker.csproj
      
      - name: Build SpriteMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: SpriteMaker
          app-path: SpriteMaker
          project-file: SpriteMaker.csproj
      
      - name: Build ModelTextureMaker
        uses: ./.github/actions/dotnet-publish-zip-lin
        with:
          app-name: ModelTextureMaker
          app-path: ModelTextureMaker
          project-file: ModelTextureMaker.csproj